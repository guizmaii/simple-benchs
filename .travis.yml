sudo: false
services:
  - docker
language: scala
scala:
  - 2.12.10
addons:
  hosts:
    - broker
script:
  - git clone https://github.com/simplesourcing/simplesource-examples
  - cd simplesource-examples
  - mvn install -q
  - cd ..
  - git clone https://github.com/guizmaii/simplesource.git
  - cd simplesource
  - git checkout eventsourceapp_builder
  - mvn install -q
  - cd ..
  - docker-compose down
  - docker-compose up -d --force-recreate --renew-anon-volumes
  - sbt ++$TRAVIS_SCALA_VERSION clean gatling:test
  - docker-compose down
  - docker-compose up -d --force-recreate --renew-anon-volumes
  - sbt ++$TRAVIS_SCALA_VERSION clean gatling-it:test
jdk:
  - openjdk8
  - openjdk11

# Comes from: https://github.com/http4s/http4s/blob/master/.travis.yml#L109
cache:
  directories:
    - "$HOME/.cache"
    - "$HOME/.ivy2/cache"
    - "$HOME/.sbt/boot"
    - "$HOME/.m2"